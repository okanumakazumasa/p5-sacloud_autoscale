# fake-autoscale

これは、さくらのクラウドに対して、以下の操作を行い、それなりにスケールアウト・スケールインさせる仕組みである。

## 制約

- さくらのクラウドでは、ディスクのコピー、書き換えなど便利な機能が提供されているが、コピーなどにはそれなりの時間がかかること、利用していたVMに対して書き換えを実行したもののうまく取り扱えなかったため、使用しない
- スケールアウトする最大台数は、固定としその台数分だけディスクを作っておく。スケールインする際には、サーバーのみ廃棄し、ディスクへの操作は行わない
- スケールアウト、スケールインのトリガーなどはこのコードには存在しない

## これらのスクリプトがやること/やりたいこと

1. サーバーの作成(スケールアウト)
  a. プラン設定
  b. ネットワーク設定
2. 1.で作ったサーバーへのディスクの接続
3. 1.で作ったサーバーの起動

2. サーバーの廃棄(スケールイン)
  a. シャットダウン
  b. 削除


## スクリプト

``` bash
for x in $(seq 1 10)
do
carton exec -- perl specify_vm.pl --api etc/api.yml --server etc/disk.yml --vm sandbox-app$x --power off
done
```

